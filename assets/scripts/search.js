/*!
 * mapache-godofredoninja v3.1.0
 * Copyright 2019 GodoFredoNinja <hello@godofredo.ninja> (https://github.com/godofredoninja/mapache)
 * Licensed under gpl-3.0
 */!function i(l,u,a){function s(t,e){if(!u[t]){if(!l[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(c)return c(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var o=u[t]={exports:{}};l[t][0].call(o.exports,function(e){return s(l[t][1][e]||e)},o,o.exports,i,l,u,a)}return u[t].exports}for(var c="function"==typeof require&&require,e=0;e<a.length;e++)s(a[e]);return s}({1:[function(e,t,r){t.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},{}],2:[function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}t.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},{}],3:[function(e,t,r){t.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},{}],4:[function(e,t,r){t.exports=function(e){return e&&e.__esModule?e:{default:e}}},{}],5:[function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?t.exports=o=function(e){return n(e)}:t.exports=o=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},o(e)}t.exports=o},{}],6:[function(i,r,e){(function(B){var e,t;e=this,t=function(){var q=void 0!==i&&"undefined"==typeof window,r=new Map,n=new Map,j=[];j.total=0;var w=[],T=[];function t(){r.clear(),n.clear(),w=[],T=[]}function D(e){for(var t=-9007199254740991,r=e.length-1;0<=r;--r){var n=e[r];if(null!==n){var o=n.score;t<o&&(t=o)}}return-9007199254740991===t?null:t}function E(e,t){var r=e[t];if(void 0!==r)return r;var n=t;Array.isArray(t)||(n=t.split("."));for(var o=n.length,i=-1;e&&++i<o;)e=e[n[i]];return e}function P(e){return"object"==typeof e}var o=function(){var i=[],l=0,e={};function t(){for(var e=0,t=i[e],r=1;r<l;){var n=r+1;e=r,n<l&&i[n].score<i[r].score&&(e=n),i[e-1>>1]=i[e],r=1+(e<<1)}for(var o=e-1>>1;0<e&&t.score<i[o].score;o=(e=o)-1>>1)i[e]=i[o];i[e]=t}return e.add=function(e){var t=l;i[l++]=e;for(var r=t-1>>1;0<t&&e.score<i[r].score;r=(t=r)-1>>1)i[t]=i[r];i[t]=e},e.poll=function(){if(0!==l){var e=i[0];return i[0]=i[--l],t(),e}},e.peek=function(e){if(0!==l)return i[0]},e.replaceTop=function(e){i[0]=e,t()},e},k=o();return function e(I){var _={single:function(e,t,r){return e?(P(e)||(e=_.getPreparedSearch(e)),t?(P(t)||(t=_.getPrepared(t)),((r&&void 0!==r.allowTypo?r.allowTypo:!I||void 0===I.allowTypo||I.allowTypo)?_.algorithm:_.algorithmNoTypo)(e,t,e[0])):null):null},go:function(e,t,r){if(!e)return j;var n=(e=_.prepareSearch(e))[0],o=r&&r.threshold||I&&I.threshold||-9007199254740991,i=r&&r.limit||I&&I.limit||9007199254740991,l=(r&&void 0!==r.allowTypo?r.allowTypo:!I||void 0===I.allowTypo||I.allowTypo)?_.algorithm:_.algorithmNoTypo,u=0,a=0,s=t.length;if(r&&r.keys)for(var c=r.scoreFn||D,f=r.keys,p=f.length,d=s-1;0<=d;--d){for(var h=t[d],y=new Array(p),v=p-1;0<=v;--v)(b=E(h,g=f[v]))?(P(b)||(b=_.getPrepared(b)),y[v]=l(e,b,n)):y[v]=null;y.obj=h;var m=c(y);null!==m&&(m<o||(y.score=m,u<i?(k.add(y),++u):(++a,m>k.peek().score&&k.replaceTop(y))))}else if(r&&r.key){var g=r.key;for(d=s-1;0<=d;--d)(b=E(h=t[d],g))&&(P(b)||(b=_.getPrepared(b)),null!==(w=l(e,b,n))&&(w.score<o||(w={target:w.target,_targetLowerCodes:null,_nextBeginningIndexes:null,score:w.score,indexes:w.indexes,obj:h},u<i?(k.add(w),++u):(++a,w.score>k.peek().score&&k.replaceTop(w)))))}else for(d=s-1;0<=d;--d){var b,w;(b=t[d])&&(P(b)||(b=_.getPrepared(b)),null!==(w=l(e,b,n))&&(w.score<o||(u<i?(k.add(w),++u):(++a,w.score>k.peek().score&&k.replaceTop(w)))))}if(0===u)return j;var T=new Array(u);for(d=u-1;0<=d;--d)T[d]=k.poll();return T.total=u+a,T},goAsync:function(A,S,L){var C=!1,e=new Promise(function(d,h){if(!A)return d(j);var y=(A=_.prepareSearch(A))[0],v=o(),m=S.length-1,g=L&&L.threshold||I&&I.threshold||-9007199254740991,b=L&&L.limit||I&&I.limit||9007199254740991,w=(L&&void 0!==L.allowTypo?L.allowTypo:!I||void 0===I.allowTypo||I.allowTypo)?_.algorithm:_.algorithmNoTypo,T=0,k=0;function x(){if(C)return h("canceled");var e=Date.now();if(L&&L.keys)for(var t=L.scoreFn||D,r=L.keys,n=r.length;0<=m;--m){for(var o=S[m],i=new Array(n),l=n-1;0<=l;--l)(s=E(o,a=r[l]))?(P(s)||(s=_.getPrepared(s)),i[l]=w(A,s,y)):i[l]=null;i.obj=o;var u=t(i);if(null!==u&&!(u<g)&&(i.score=u,T<b?(v.add(i),++T):(++k,u>v.peek().score&&v.replaceTop(i)),m%1e3==0&&10<=Date.now()-e))return void(q?B(x):setTimeout(x))}else if(L&&L.key){for(var a=L.key;0<=m;--m)if((s=E(o=S[m],a))&&(P(s)||(s=_.getPrepared(s)),null!==(c=w(A,s,y))&&!(c.score<g)&&(c={target:c.target,_targetLowerCodes:null,_nextBeginningIndexes:null,score:c.score,indexes:c.indexes,obj:o},T<b?(v.add(c),++T):(++k,c.score>v.peek().score&&v.replaceTop(c)),m%1e3==0&&10<=Date.now()-e)))return void(q?B(x):setTimeout(x))}else for(;0<=m;--m){var s,c;if((s=S[m])&&(P(s)||(s=_.getPrepared(s)),null!==(c=w(A,s,y))&&!(c.score<g)&&(T<b?(v.add(c),++T):(++k,c.score>v.peek().score&&v.replaceTop(c)),m%1e3==0&&10<=Date.now()-e)))return void(q?B(x):setTimeout(x))}if(0===T)return d(j);for(var f=new Array(T),p=T-1;0<=p;--p)f[p]=v.poll();f.total=T+k,d(f)}q?B(x):x()});return e.cancel=function(){C=!0},e},highlight:function(e,t,r){if(null===e)return null;void 0===t&&(t="<b>"),void 0===r&&(r="</b>");for(var n="",o=0,i=!1,l=e.target,u=l.length,a=e.indexes,s=0;s<u;++s){var c=l[s];if(a[o]===s){if(i||(i=!0,n+=t),++o===a.length){n+=c+r+l.substr(s+1);break}}else i&&(i=!1,n+=r);n+=c}return n},prepare:function(e){if(e)return{target:e,_targetLowerCodes:_.prepareLowerCodes(e),_nextBeginningIndexes:null,score:null,indexes:null,obj:null}},prepareSlow:function(e){if(e)return{target:e,_targetLowerCodes:_.prepareLowerCodes(e),_nextBeginningIndexes:_.prepareNextBeginningIndexes(e),score:null,indexes:null,obj:null}},prepareSearch:function(e){if(e)return _.prepareLowerCodes(e)},getPrepared:function(e){if(999<e.length)return _.prepare(e);var t=r.get(e);return void 0!==t||(t=_.prepare(e),r.set(e,t)),t},getPreparedSearch:function(e){if(999<e.length)return _.prepareSearch(e);var t=n.get(e);return void 0!==t||(t=_.prepareSearch(e),n.set(e,t)),t},algorithm:function(e,t,r){for(var n=t._targetLowerCodes,o=e.length,i=n.length,l=0,u=0,a=0,s=0;;){if(r===n[u]){if(w[s++]=u,++l===o)break;r=e[0===a?l:a===l?l+1:a===l-1?l-1:l]}if(i<=++u)for(;;){if(l<=1)return null;if(0===a){if(r===e[--l])continue;a=l}else{if(1===a)return null;if((r=e[1+(l=--a)])===e[l])continue}u=w[(s=l)-1]+1;break}}var c=l=0,f=!1,p=0,d=t._nextBeginningIndexes;null===d&&(d=t._nextBeginningIndexes=_.prepareNextBeginningIndexes(t.target));var h=u=0===w[0]?0:d[w[0]-1];if(u!==i)for(;;)if(i<=u){if(l<=0){if(o-2<++c)break;if(e[c]===e[c+1])continue;u=h;continue}--l,u=d[T[--p]]}else if(e[0===c?l:c===l?l+1:c===l-1?l-1:l]===n[u]){if(T[p++]=u,++l===o){f=!0;break}++u}else u=d[u];if(f)var y=T,v=p;else y=w,v=s;for(var m=0,g=-1,b=0;b<o;++b)g!==(u=y[b])-1&&(m-=u),g=u;for(f?0!==c&&(m+=-20):(m*=1e3,0!==a&&(m+=-20)),m-=i-o,t.score=m,t.indexes=new Array(v),b=v-1;0<=b;--b)t.indexes[b]=y[b];return t},algorithmNoTypo:function(e,t,r){for(var n=t._targetLowerCodes,o=e.length,i=n.length,l=0,u=0,a=0;;){if(r===n[u]){if(w[a++]=u,++l===o)break;r=e[l]}if(i<=++u)return null}var s=!1,c=l=0,f=t._nextBeginningIndexes;if(null===f&&(f=t._nextBeginningIndexes=_.prepareNextBeginningIndexes(t.target)),(u=0===w[0]?0:f[w[0]-1])!==i)for(;;)if(i<=u){if(l<=0)break;--l,u=f[T[--c]]}else if(e[l]===n[u]){if(T[c++]=u,++l===o){s=!0;break}++u}else u=f[u];if(s)var p=T,d=c;else p=w,d=a;for(var h=0,y=-1,v=0;v<o;++v)y!==(u=p[v])-1&&(h-=u),y=u;for(s||(h*=1e3),h-=i-o,t.score=h,t.indexes=new Array(d),v=d-1;0<=v;--v)t.indexes[v]=p[v];return t},prepareLowerCodes:function(e){for(var t=e.length,r=[],n=e.toLowerCase(),o=0;o<t;++o)r[o]=n.charCodeAt(o);return r},prepareBeginningIndexes:function(e){for(var t=e.length,r=[],n=0,o=!1,i=!1,l=0;l<t;++l){var u=e.charCodeAt(l),a=65<=u&&u<=90,s=a||97<=u&&u<=122||48<=u&&u<=57,c=a&&!o||!i||!s;o=a,i=s,c&&(r[n++]=l)}return r},prepareNextBeginningIndexes:function(e){for(var t=e.length,r=_.prepareBeginningIndexes(e),n=[],o=r[0],i=0,l=0;l<t;++l)l<o?n[l]=o:(o=r[++i],n[l]=void 0===o?t:o);return n},cleanup:t,new:e};return _}()},"function"==typeof define&&define.amd?define([],t):"object"==typeof r&&r.exports?r.exports=t():e.fuzzysort=t()}).call(this,i("timers").setImmediate)},{timers:8}],7:[function(e,t,r){var n,o,i=t.exports={};function l(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===l||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:l}catch(e){n=l}try{o="function"==typeof clearTimeout?clearTimeout:u}catch(e){o=u}}();var s,c=[],f=!1,p=-1;function d(){f&&s&&(f=!1,s.length?c=s.concat(c):p=-1,c.length&&h())}function h(){if(!f){var e=a(d);f=!0;for(var t=c.length;t;){for(s=c,c=[];++p<t;)s&&s[p].run();p=-1,t=c.length}s=null,f=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===u||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(e)}}function y(e,t){this.fun=e,this.array=t}function v(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new y(e,t)),1!==c.length||f||a(h)},y.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],8:[function(a,e,s){(function(e,t){var n=a("process/browser.js").nextTick,r=Function.prototype.apply,o=Array.prototype.slice,i={},l=0;function u(e,t){this._id=e,this._clearFn=t}s.setTimeout=function(){return new u(r.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new u(r.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(e){e.close()},u.prototype.unref=u.prototype.ref=function(){},u.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},s.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},s._unrefActive=s.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},s.setImmediate="function"==typeof e?e:function(e){var t=l++,r=!(arguments.length<2)&&o.call(arguments,1);return i[t]=!0,n(function(){i[t]&&(r?e.apply(null,r):e.call(null),s.clearImmediate(t))}),t},s.clearImmediate="function"==typeof t?t:function(e){delete i[e]}}).call(this,a("timers").setImmediate,a("timers").clearImmediate)},{"process/browser.js":7,timers:8}],9:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault"),o=n(e("@babel/runtime/helpers/defineProperty")),i=n(e("@babel/runtime/helpers/typeof")),l=n(e("@babel/runtime/helpers/classCallCheck")),u=n(e("@babel/runtime/helpers/createClass")),a=e("fuzzysort"),s=function(){function n(e){(0,l.default)(this,n),this.check=!1;var t={url:siteUrl,key:"",version:"v2",input:"#search-field",results:"#search-results",button:"",defaultValue:"",template:function(e){return'<a href="'.concat(siteUrl,"/").concat(e.slug,'/">').concat(e.title,"</a>")},trigger:"focus",options:{keys:["title"],limit:10,threshold:-3500,allowTypo:!1},api:{resource:"posts",parameters:{limit:"all",fields:["title","slug"],filter:"",include:"",order:"",formats:"",page:""}},on:{beforeDisplay:function(){},afterDisplay:function(e){},beforeFetch:function(){},afterFetch:function(e){}}},r=this.mergeDeep(t,e);Object.assign(this,r),this.init()}return(0,u.default)(n,[{key:"mergeDeep",value:function(t,r){var n=this;return t&&"object"===(0,i.default)(t)&&!Array.isArray(t)&&null!==t&&r&&"object"===(0,i.default)(r)&&!Array.isArray(r)&&null!==r&&Object.keys(r).forEach(function(e){r[e]&&"object"===(0,i.default)(r[e])&&!Array.isArray(r[e])&&null!==r[e]?(t[e]||Object.assign(t,(0,o.default)({},e,{})),n.mergeDeep(t[e],r[e])):Object.assign(t,(0,o.default)({},e,r[e]))}),t}},{key:"fetch",value:function(){var t=this;this.on.beforeFetch();var e=new GhostContentAPI({url:this.url,key:this.key,version:this.version}),r={},n=this.api.parameters;for(var o in n)""!==n[o]&&(r[o]=n[o]);e[this.api.resource].browse(r).then(function(e){t.search(e)}).catch(function(e){console.error(e)})}},{key:"createElementFromHTML",value:function(e){var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild}},{key:"displayResults",value:function(e){if(null!==document.querySelectorAll(this.results)[0].firstChild&&""!==document.querySelectorAll(this.results)[0].firstChild)for(;document.querySelectorAll(this.results)[0].firstChild;)document.querySelectorAll(this.results)[0].removeChild(document.querySelectorAll(this.results)[0].firstChild);var t=document.querySelectorAll(this.input)[0].value;""!==this.defaultValue&&(t=this.defaultValue);var r=a.go(t,e,{keys:this.options.keys,limit:this.options.limit,allowTypo:this.options.allowTypo,threshold:this.options.threshold});for(var n in r)n<r.length&&document.querySelectorAll(this.results)[0].appendChild(this.createElementFromHTML(this.template(r[n].obj)));this.on.afterDisplay(r),this.defaultValue=""}},{key:"search",value:function(t){var r=this;if(this.on.afterFetch(t),this.check=!0,""!==this.defaultValue&&(this.on.beforeDisplay(),this.displayResults(t)),""!==this.button){var e=document.querySelectorAll(this.button)[0];"INPUT"===e.tagName&&"submit"===e.type&&e.closest("form").addEventListener("submit",function(e){e.preventDefault()}),e.addEventListener("click",function(e){e.preventDefault(),r.on.beforeDisplay(),r.displayResults(t)})}else document.querySelectorAll(this.input)[0].addEventListener("keyup",function(){r.on.beforeDisplay(),r.displayResults(t)})}},{key:"checkArgs",value:function(){return document.querySelectorAll(this.input).length?document.querySelectorAll(this.results).length?""===this.button||document.querySelectorAll(this.button).length?""===this.url?(console.log("Content API Client Library url missing. Please set the url. Must not end in a trailing slash."),!1):""!==this.key||(console.log('Content API Client Library key missing. Please set the key. Hex string copied from the "Integrations" screen in Ghost Admin.'),!1):(console.log("Button not found."),!1):(console.log("Results not found."),!1):(console.log("Input not found."),!1)}},{key:"validate",value:function(){return!!this.checkArgs()}},{key:"init",value:function(){var e=this;this.validate()&&(""!==this.defaultValue&&(document.querySelectorAll(this.input)[0].value=this.defaultValue,window.onload=function(){e.check||e.fetch()}),"focus"===this.trigger?document.querySelectorAll(this.input)[0].addEventListener("focus",function(){e.check||e.fetch()}):"load"===this.trigger&&(window.onload=function(){e.check||e.fetch()}))}}]),n}();t.exports=s},{"@babel/runtime/helpers/classCallCheck":1,"@babel/runtime/helpers/createClass":2,"@babel/runtime/helpers/defineProperty":3,"@babel/runtime/helpers/interopRequireDefault":4,"@babel/runtime/helpers/typeof":5,fuzzysort:6}],10:[function(e,t,r){"use strict";var p=e("@babel/runtime/helpers/interopRequireDefault")(e("./app/app.search"));!function(l,r){var e=r.querySelector.bind(r),t=r.querySelectorAll.bind(r),n=r.body,o=e("#search-field"),u=e("#search-results"),i=e(".js-search-message"),a={outer:0,scroll:0};e(".js-search-open").classList.remove("u-hide");var s={on:{beforeFetch:function(){return n.classList.add("is-loading")},afterFetch:function(){return setTimeout(function(){n.classList.remove("is-loading")},4e3)},afterDisplay:function(e){c(),a={outer:u.offsetHeight,scroll:u.scrollHeight},0===e.total&&""!==o.value?i.classList.remove("u-hide"):i.classList.add("u-hide")}}};function c(e,t){if(e=e||0,t=t||"up",!(l.innerWidth<768)){var r=u.querySelectorAll("a");if(r.length){var n=u.querySelector("a.search-result--active");n&&n.classList.remove("search-result--active"),r[e].classList.add("search-result--active");var o=r[e].offsetTop,i=0;"down"===t&&o>a.outer/2?i=o-a.outer/2:"up"===t&&(i=o<a.scroll-a.outer/2?o-a.outer/2:a.scroll),u.scrollTo(0,i)}}}function f(e){e.preventDefault();var t=e.keyCode;27===t?(n.classList.remove("has-search"),r.removeEventListener("keyup",f)):13===t?(o.blur(),function(){var e=u.querySelector("a.search-result--active");e&&e.click()}()):38===t||40===t?function(e){var t,r=0,n=u.querySelector(".search-result--active");n&&(r=[].slice.call(n.parentNode.children).indexOf(n)),o.blur(),38===e?(t="up",r<=0?(o.focus(),r=0):r-=1):(t="down",r>=u.querySelectorAll("a").length-1?r=u.querySelectorAll("a").length-1:r+=1),c(r,t)}(t):191===t&&(o.focus(),o.setSelectionRange(0,o.value.length))}Object.assign(s,searchSettings),t(".js-search-open").forEach(function(e){return e.addEventListener("click",function(e){e.preventDefault(),n.classList.add("has-search"),o.focus(),768<l.innerWidth&&r.addEventListener("keyup",f)})}),t(".js-search-close").forEach(function(e){return e.addEventListener("click",function(e){e.preventDefault(),n.classList.remove("has-search"),r.removeEventListener("keyup",f)})}),new p.default(s)}(window,document)},{"./app/app.search":9,"@babel/runtime/helpers/interopRequireDefault":4}]},{},[10]);